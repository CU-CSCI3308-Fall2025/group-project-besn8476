{{> head }}
{{> siteheader }}
{{> message}}

<section class="section">
  <h2 class="section-title">Available Items</h2>
  <div class="container">
    <form action="/api/posts/search" method="GET" class="search-bar">
      <input 
        type="text" 
        name="q"
        placeholder="Search items..."
        value="{{query}}"
        class="search-input"
      >
      <button type="submit" class="btn btn-secondary">Search</button>

      <a href="/post" class="btn btn-ghost">Clear</a>
    </form>

    <div class="row row-cols-1 row-cols-md-3 g-4">  
        {{#each results}}
          <div class="col">
            <div class="card">
                <img
                  src="{{#if images.[0].url}}{{images.[0].url}}{{else}}https://via.placeholder.com/400x250?text=No+Image+Available{{/if}}"
                  alt="{{name}}"
                  class="card-image"
                >
                <div class="card-body">
                    <h3 class="card-title">{{name}}</h3>
                    <p class="card-description">
                      {{#if product.info}}
                        <strong>Desc:</strong> {{product.info}}<br>
                      {{/if}}
                      {{#if user.contact}}
                        <strong>Contact:</strong> {{user.contact}}
                      {{/if}}
                    </p>

                    <!-- Button to open modal -->
                    <button
                      type="button"
                      class="btn post-card-view"
                      data-name="{{name}}"
                      data-description="{{product.info}}"
                      data-contacts="{{user.contact}}"
                      data-img="{{#if images.[0].url}}{{images.[0].url}}{{else}}https://via.placeholder.com/400x250?text=No+Image+Available{{/if}}"
                    >
                      View Details
                    </button>
                </div>
            </div>
          </div>
        {{/each}}
    </div>
  </div>
</section>

<!-- Modal for item details  -->
<div id="post-modal-backdrop" class="modal-backdrop hidden">
  <div class="modal">
    <button class="post-modal-close modal-close" aria-label="Close">&times;</button>
    <img id="modal-image" class="modal-image" alt="Post image">
    <h3 id="modal-title"></h3>
    <p id="modal-description"></p>
    <p id="modal-contact" class="modal-contact"></p>
  </div>
</div>


{{>footer}}

<script src="/modal.js"></script>